---
// Types
import type { CaseStudy } from '../../types/sanity.types';
// Components
import CaseStudyCard from '@components/CaseStudy/CaseStudyCard.astro';

interface Props {
	relatedCaseStudies: CaseStudy[] | undefined;
}

const { relatedCaseStudies } = Astro.props;
---

<section class="section page__section dark">
	<h3 class="fade-in">
		And many more, built just the way our <span class="text-violet">customers needed them.</span>
	</h3>
	<div class="related__cases fade-in">
		<div class="swiper-wrapper w-full">
			{
				relatedCaseStudies &&
					relatedCaseStudies?.map((caseStudy: CaseStudy) => (
						<div class="swiper-slide xl:w-full">
							<CaseStudyCard caseStudy={caseStudy} simple dark />
						</div>
					))
			}
		</div>
		<div class="swiper-navigation">
			<div class="swiper-button-prev">
				<svg xmlns="http://www.w3.org/2000/svg" width="21" height="19" viewBox="0 0 21 19" fill="none">
					<path
						d="M11.5149 1.27627L20.0501 9.81156M20.0501 9.81156L11.5149 18.3469M20.0501 9.81156H0.893821"
						stroke="white"></path>
				</svg>
			</div>
			<div class="swiper-button-next">
				<svg xmlns="http://www.w3.org/2000/svg" width="21" height="19" viewBox="0 0 21 19" fill="none">
					<path
						d="M11.5149 1.27627L20.0501 9.81156M20.0501 9.81156L11.5149 18.3469M20.0501 9.81156H0.893821"
						stroke="white"></path>
				</svg>
			</div>
		</div>
	</div>
</section>
<style>
	h3 {
		color: #fff;
		font-family: var(--font-titles);
		font-size: 28px;
		font-style: normal;
		font-weight: 400;
		line-height: 109%;
		margin-bottom: 24px;
	}
	.text-violet {
		color: rgb(var(--clr-violet));
	}

	/* Navigation buttons styling */
	.swiper-navigation {
		display: flex;
		justify-content: center;
		align-items: center;
		gap: 16px;
		margin-top: 16px;
	}

	.swiper-button-next,
	.swiper-button-prev {
		position: static;
		width: 48px;
		height: 48px;
		background: rgba(255, 255, 255, 0);
		border: 1px solid rgba(255, 255, 255, 0.2);
		border-radius: 50%;
		display: flex;
		align-items: center;
		justify-content: center;
		cursor: pointer;
		transition: all 0.3s ease;
		backdrop-filter: blur(10px);
		margin: 0;
	}
	.swiper-button-disabled {
		opacity: 0.3;
		pointer-events: none;
	}

	.swiper-button-next:hover,
	.swiper-button-prev:hover {
		background: rgba(255, 255, 255, 0.2);
		border-color: rgba(255, 255, 255, 0.4);
		transform: scale(1.05);
	}

	.swiper-button-prev {
		transform: rotate(180deg);
	}

	.swiper-button-prev:hover {
		transform: rotate(180deg) scale(1.05);
	}

	.swiper-button-next::after,
	.swiper-button-prev::after {
		display: none;
	}

	/* Hide navigation on mobile */
	@media (max-width: 767px) {
		/* .swiper-navigation {
			display: none;
		} */
	}

	@media (min-width: 768px) {
		h3 {
			margin-bottom: 42px;
		}
		.swiper-navigation {
			margin-top: 32px;
		}
	}
</style>

<script>
	import Swiper from 'swiper';
	import 'swiper/css';
	import { Navigation } from 'swiper/modules';

	new Swiper('.related__cases', {
		modules: [Navigation],
		freeMode: true,
		slidesPerView: 1.1,
		spaceBetween: 24,
		navigation: {
			nextEl: '.swiper-button-next',
			prevEl: '.swiper-button-prev',
		},
		breakpoints: {
			470: {
				slidesPerView: 1.2,
			},
			540: {
				slidesPerView: 1.3,
			},
			640: {
				slidesPerView: 1.6,
			},
			768: {
				slidesPerView: 1.8,
			},
			820: {
				slidesPerView: 2.1,
			},
			950: {
				slidesPerView: 3,
			},
		},
	});
</script>

<style>
	.swiper-slide {
		width: 368px;
		height: auto;
	}
</style>
